---
import DynamicComponent from './DynamicComponent.astro'

interface Props {
  title?: string
  items?: any[]
  showScrollbar?: boolean
  className?: string
  _key?: string
  _type?: string
}

const {
  title,
  items = [],
  showScrollbar = false,
  className = '',
  _key,
  _type,
} = Astro.props

// CSS classes
const scrollbarClass = showScrollbar ? '' : 'hide-scrollbar'

// Sanity Visual Editing attributes
const sanityAttributes = _key ? { 'data-sanity': `${_type}.${_key}` } : {}
---

<section class={`content-scroll-container ${scrollbarClass} ${className}`} {...sanityAttributes}>
  {title && <h2 class="scroll-container-title">{title}</h2>}

  <ul class="scroll-list">
    {items.map((item) => {
      if (!item) return null

      return (
        <li class="scroll-item">
          <DynamicComponent block={item} />
        </li>
      )
    })}
  </ul>
</section>

<style>
  .content-scroll-container {
    width: min(100ch, 100% - 4rem);
    margin-inline: auto;
    margin-block: 3rem;
  }

  .scroll-container-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    text-align: center;
  }

  .scroll-list {
    display: flex;
    gap: 1.5rem;
    list-style: none;
    margin: 0;
    padding: 0.5rem 0 1rem 0;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
  }

  .scroll-item {
    flex-shrink: 0;
    width: 280px; /* Desktop width */
    aspect-ratio: 4 / 5; /* All cards are 4:5 */
    border-radius: 8px;
    overflow: hidden;
    position: relative;
  }

  /* Make child components fill the scroll item */
  .scroll-item > :global(*) {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Hide scrollbar */
  .hide-scrollbar .scroll-list {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE/Edge */
  }

  .hide-scrollbar .scroll-list::-webkit-scrollbar {
    display: none; /* Chrome/Safari */
  }

  /* Tablet: Slightly smaller cards */
  @media (max-width: 1024px) {
    .scroll-item {
      width: 240px;
    }

    .scroll-list {
      gap: 1.25rem;
    }
  }

  /* Mobile: Smaller cards */
  @media (max-width: 768px) {
    .content-scroll-container {
      margin: 2rem 0;
    }

    .scroll-container-title {
      font-size: 1.25rem;
      margin-bottom: 1rem;
    }

    .scroll-item {
      width: 200px;
    }

    .scroll-list {
      gap: 1rem;
    }
  }

  /* Accessibility */
  .scroll-item:focus-within {
    outline: 2px solid #0066cc;
    outline-offset: 2px;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .scroll-list {
      scroll-behavior: auto;
    }
  }
</style> 